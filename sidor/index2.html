<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeliveryMaster v32.0.1 (תיקון SmartLog)</title>
    <!-- 
      DeliveryMaster Admin App v32.0.1
      
      Changelog:
      - v32.0.1 (תיקון SmartLog):
        - תוקנה שגיאת JavaScript שבה הפונקציה SmartLog.info לא הייתה מוגדרת בזמן הקריאה הראשונה. ההגדרה הועברה למיקום מוקדם יותר בסקריפט.
      - v32.0 (ניהול מכולות):
        - נוספו מחסנים וירטואליים: "30-שארק", "32-כראדי", "40-כראדי".
        - נוסף דף "מכולות" חדש לניהול ומעקב אחר השכרות.
        - הוטמעה לוגיקה למעקב ימי שכירות (10 ימים).
        - סוגי הובלה ("הצבה", "החלפה", "הוצאה") משפיעים על מעקב השכירות.
        - נוסף שדה 'rentalStartDate' למסמכי הזמנה רלוונטיים.
        - דף המכולות מציג לקוחות פעילים לפי מחסן, ימי שכירות (עם פס התקדמות), ומדגיש חריגות באדום מהבהב.
        - נוספה אפשרות עריכת הזמנת מכולה מהדף החדש.
      - v31.9.2 (הוספת סוגי הובלה):
        - נוספו אפשרויות נוספות לשדה 'סוג הובלה' בטופס הזמנה חדשה.
      - v31.9.1 (הוספת שעת אספקה):
        - נוסף שדה <input type="time"> לטופס יצירת הזמנה חדשה ושמירתו.
      - v31.9: Added Global Ping functionality.
      ... (היסטוריית גרסאות קודמת)
    -->
    
    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- LeafletJS (Map) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Icons (Feather) -->
    <script src="https://unpkg.com/feather-icons"></script>
    
    <!-- Google Font: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #3b82f6; /* blue-500 */
            --primary-dark: #2563eb; /* blue-600 */
            --bg-light: #f3f4f6; /* gray-100 */
            --bg-white: #ffffff;
            --border-color: #e5e7eb; /* gray-200 */
            --text-dark: #1f2937; /* gray-800 */
            --text-light: #6b7280; /* gray-500 */
            --text-dark-nav: #d1d5db; /* gray-300 */
            --bg-dark-nav: #1f2937; /* slate-800 */
            --bg-dark-nav-hover: #374151; /* slate-700 */
            --danger-soft: #fee2e2; /* red-100 */
            --danger-medium: #f87171; /* red-400 */
            --danger-dark: #dc2626; /* red-600 */
        }
        body {
            font-family: 'Inter', 'Arial', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            overflow: hidden;
        }
        
        /* Layout */
        .app-layout {
            display: grid;
            grid-template-columns: auto 1fr;
            height: 100vh;
        }
        
        /* App Views */
        .app-view {
            width: 100%;
            height: 100vh;
            overflow: hidden; /* Prevent scrolling on main views */
            display: none; /* Hidden by default */
        }
        .app-view.active {
            display: block; /* Show active view */
        }
        
        #view-dashboard {
            display: grid; /* Use grid for dashboard */
            grid-template-columns: 1fr 350px;
            overflow: hidden;
        }
        .app-view.active#view-dashboard { display: grid; } /* Override default block for dashboard */
        
        #view-history, #view-containers { /* Allow scrolling for History and Containers */
            overflow-y: auto; 
            padding: 1.5rem 2.5rem;
        }

        #view-driver-history {
             display: grid; /* Use grid for driver history */
             grid-template-columns: 300px 1fr; /* Sidebar and Map */
             height: 100vh;
        }
        .app-view.active#view-driver-history { display: grid; } /* Override default block */
        
        #map-container {
            position: relative;
            background-color: #e0e0e0;
        }
        #map {
            height: 100%;
            width: 100%;
        }
        #side-panel {
            background-color: var(--bg-white);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        /* Navbar */
        #navbar {
            background-color: var(--bg-dark-nav);
            border-left: 1px solid var(--border-color);
            color: white;
            z-index: 10;
        }
        #navbar .text-xl { color: white; }
        .nav-link { transition: all 0.2s; color: var(--text-dark-nav); }
        .nav-link:hover { background-color: var(--bg-dark-nav-hover); color: white; }
        .nav-link.active { background-color: var(--primary-color); color: white; border-right: 3px solid #60a5fa; }
        .nav-link-special { color: var(--text-dark-nav); background-color: var(--bg-dark-nav-hover); }
        .nav-link-special:hover { background-color: var(--primary-color); color: white; }
        #navbar .hidden.lg\\:block { color: white; }
        #navbar #last-updated { color: var(--text-light); }

        /* Side Panel */
        #side-panel-lists { flex: 1; overflow-y: auto; position: relative; }
        .panel-list { overflow-y: auto; position: relative; }
        .order-card, .driver-card { padding: 1rem; border-bottom: 1px solid var(--border-color); transition: background-color 0.2s; }
        .order-card:hover, .driver-card:hover { background-color: #fafafa; }
        .order-card.active, .driver-card.active { background-color: #eff6ff; border-right: 3px solid var(--primary-color); }
        .order-card .font-bold { color: var(--primary-dark); }
        
        /* Details Panel */
        #details-panel { height: 300px; overflow-y: auto; border-top: 2px solid var(--border-color); background: #fdfdfd; padding: 1rem; display: none; position: relative; }
        #details-panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        #details-panel h4 { font-weight: 700; color: var(--text-dark); }
        #details-panel ul { list-style-type: none; padding: 0; margin: 0; }
        #details-panel li { font-size: 0.9rem; margin-bottom: 4px; color: var(--text-light); }
        #details-panel .status-line { display: flex; align-items: center; gap: 0.5rem; }
        #details-panel li .dist { font-weight: 500; color: var(--text-dark); display: inline-block; min-width: 60px; text-align: left; }
        #details-close-btn, #details-copy-link-btn { cursor: pointer; color: var(--text-light); }
        #details-close-btn:hover, #details-copy-link-btn:hover { color: var(--text-dark); }
        .status-change-btn { background: none; border: none; color: var(--primary-color); font-size: 0.8rem; font-weight: 500; cursor: pointer; padding: 2px 4px; border-radius: 4px; }
        .status-change-btn:hover { background-color: #eff6ff; color: var(--primary-dark); }

        /* History & Customer Management View */
         #view-history .tab-button, #view-containers .tab-button { /* Apply to both */
            padding: 0.75rem 1.5rem; cursor: pointer; border-bottom: 3px solid transparent; font-weight: 500; color: var(--text-light); }
         #view-history .tab-button.active, #view-containers .tab-button.active { border-bottom-color: var(--primary-color); color: var(--primary-color); }
        .history-table tbody tr:hover, .customer-table tbody tr:hover, .container-table tbody tr:hover { background-color: #f9fafb; }
        .customer-table tbody tr:hover, .container-table tbody tr:hover { cursor: pointer; } /* Make container table rows clickable for editing */
        .action-button { background-color: var(--primary-color); color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; cursor: pointer; margin-left: 4px; }
        .action-button:hover { background-color: var(--primary-dark); }
        .action-button-secondary { background-color: var(--text-light); }
        .action-button-secondary:hover { background-color: var(--text-dark); }
        
        /* Driver History View */
        #driver-history-sidebar { background-color: var(--bg-white); border-left: 1px solid var(--border-color); padding: 1rem; display: flex; flex-direction: column; gap: 1rem; }
        #driver-history-map { background-color: #e0e0e0; position: relative; }
        
        /* Containers View */
        #view-containers h2 { font-size: 1.8rem; font-weight: 700; margin-bottom: 1.5rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem; }
        .warehouse-section { margin-bottom: 2rem; }
        .warehouse-section h3 { font-size: 1.3rem; font-weight: 600; margin-bottom: 1rem; color: var(--primary-dark); }
        .container-table th, .container-table td { padding: 0.75rem 1rem; text-align: right; border-bottom: 1px solid var(--border-color); vertical-align: middle; font-size: 0.9rem; }
        .container-table th { font-weight: 500; color: var(--text-light); background-color: #f9fafb; }
        .container-table tbody tr.overdue { background-color: var(--danger-soft); animation: subtle-pulse 1.5s infinite ease-in-out; }
        .container-table td .edit-btn { color: var(--primary-color); cursor: pointer; }
        .container-table td .edit-btn:hover { color: var(--primary-dark); }
        .progress-bar-container { width: 100%; background-color: var(--border-color); border-radius: 99px; overflow: hidden; height: 10px; }
        .progress-bar { height: 100%; background-color: var(--primary-color); border-radius: 99px; transition: width 0.3s ease; }
        .progress-bar.overdue { background-color: var(--danger-medium); }
        .container-summary { margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--border-color); font-weight: 600; }
        @keyframes subtle-pulse { 0% { background-color: var(--danger-soft); } 50% { background-color: #fecaca; /* red-200 */} 100% { background-color: var(--danger-soft); } }

        /* Status Colors */
        .status-dot { width: 10px; height: 10px; border-radius: 50%; }
        .status-active { background-color: #22c55e; } .status-stuck { background-color: #ef4444; } .status-inactive { background-color: #9ca3af; }
        
        /* Leaflet Customizations */
        .leaflet-popup-content-wrapper { border-radius: 8px; }
        .leaflet-popup-content { margin: 13px 20px; font-family: 'Inter', sans-serif; }
        .leaflet-popup-content h4 { font-weight: 700; margin-bottom: 8px; }
        .leaflet-popup-content p { margin: 4px 0; color: var(--text-light); }
        
        /* Loader */
        .loader-container { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.7); display: flex; align-items: center; justify-content: center; z-index: 10; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary-color); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Toast Notification */
        #toast-container { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 5000; display: flex; flex-direction: column; gap: 8px; }
        .toast { padding: 12px 20px; background-color: var(--text-dark); color: white; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); opacity: 0; transform: translateY(20px); transition: all 0.3s ease; }
        .toast.show { opacity: 1; transform: translateY(0); }
        .toast.success { background-color: #22c55e; } .toast.error { background-color: #ef4444; }
        
        /* Modal Dialog */
        #new-order-modal, #customer-edit-modal, #container-edit-modal { /* Added container modal */
            max-width: 600px; border-radius: 12px; border: none; box-shadow: 0 10px 30px rgba(0,0,0,0.1); padding: 0; }
        #new-order-modal::backdrop, #customer-edit-modal::backdrop, #container-edit-modal::backdrop { background: rgba(0,0,0,0.5); backdrop-filter: blur(2px); }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
        
        /* Responsive */
        @media (max-width: 1024px) {
            #view-dashboard { grid-template-columns: 1fr; }
            #side-panel { position: fixed; bottom: 0; left: 0; right: 0; height: 40vh; z-index: 2000; border-right: none; border-top: 1px solid var(--border-color); transform: translateY(100%); transition: transform 0.3s ease; }
            #side-panel.open { transform: translateY(0); }
            #navbar { display: flex; width: 100%; z-index: 2001; border-left: none; border-bottom: 1px solid var(--border-color); }
            .app-layout { grid-template-columns: 1fr; grid-template-rows: auto 1fr; }
            .nav-link { flex: 1; justify-content: center; } .nav-link span { display: none; } .nav-link.active { border-right: none; border-bottom: 3px solid var(--primary-color); }
            #details-panel { height: 200px; }
            #view-driver-history { grid-template-columns: 1fr; grid-template-rows: auto 1fr; }
            #driver-history-sidebar { grid-row: 1 / 2; border-left: none; border-bottom: 1px solid var(--border-color); }
            #driver-history-map { grid-row: 2 / 3; }
            #view-history, #view-containers { padding: 1rem; } /* Less padding on mobile */
        }
    </style>
</head>
<body class="antialiased">

    <div class="app-layout">
        <!-- Navbar -->
        <nav id="navbar" class="w-20 lg:w-64 flex flex-col p-4 space-y-4">
            <div class="hidden lg:flex items-center space-x-2 space-x-reverse px-2 mb-4">
                <i data-feather="truck" class="w-8 h-8 text-blue-500"></i>
                <span class="text-xl font-bold">DeliveryMaster</span>
            </div>
            
            <a href="#" class="nav-link active flex items-center p-3 space-x-4 space-x-reverse rounded-lg" onclick="showView('dashboard')">
                <i data-feather="map" class="w-6 h-6"></i>
                <span class="font-semibold text-lg hidden lg:block">דשבורד</span>
            </a>
            <a href="#" class="nav-link flex items-center p-3 space-x-4 space-x-reverse rounded-lg" onclick="showView('history')">
                <i data-feather="archive" class="w-6 h-6"></i>
                <span class="font-semibold text-lg hidden lg:block">היסטוריה ולקוחות</span>
            </a>
             <a href="#" class="nav-link flex items-center p-3 space-x-4 space-x-reverse rounded-lg" onclick="showView('driver-history')">
                <i data-feather="navigation" class="w-6 h-6"></i>
                <span class="font-semibold text-lg hidden lg:block">היסטוריית נהגים</span>
            </a>
            <!-- *** NEW CONTAINER VIEW LINK *** -->
            <a href="#" class="nav-link flex items-center p-3 space-x-4 space-x-reverse rounded-lg" onclick="showView('containers')">
                 <i data-feather="hard-drive" class="w-6 h-6"></i> <!-- Example icon -->
                 <span class="font-semibold text-lg hidden lg:block">מכולות</span>
            </a>
            <a href="#" class="nav-link flex items-center p-3 space-x-4 space-x-reverse rounded-lg" onclick="openNewOrderForm()">
                <i data-feather="plus-circle" class="w-6 h-6"></i>
                <span class="font-semibold text-lg hidden lg:block">הזמנה חדשה</span>
            </a>
            <a href="log.html" target="_blank" class="nav-link flex items-center p-3 space-x-4 space-x-reverse rounded-lg">
                <i data-feather="file-text" class="w-6 h-6"></i>
                <span class="font-semibold text-lg hidden lg:block">לוגים</span>
            </a>
            
            <div class="flex-grow"></div> <!-- Spacer -->
            
            <a href="#" class="nav-link nav-link-special flex items-center p-3 space-x-4 space-x-reverse rounded-lg" onclick="sendGlobalPing()">
                <i data-feather="bell" class="w-6 h-6"></i>
                <span class="font-semibold text-lg hidden lg:block">שלח התראה גלובלית</span>
            </a>

            <div class="hidden lg:block border-t border-gray-700 pt-4 mt-4">
                <div class="text-sm">שלום, <span class="font-semibold">מנהל</span></div>
                <div id="last-updated" class="text-xs">מתחבר...</div>
            </div>
        </nav>

        <!-- Main Content Wrapper -->
        <div class="relative">
            <!-- Main Content (Map + Side Panel) -->
            <main id="view-dashboard" class="app-view active"> <!-- Start with dashboard active -->
                <!-- Map Container -->
                <div id="map-container">
                    <div id="map"></div>
                    <div id="map-loader" class="loader-container">
                        <div class="loader"></div>
                        <span class="ml-4 font-semibold">טוען מפה ומאמת...</span>
                    </div>
                </div>

                <!-- Side Panel (Lists) -->
                <aside id="side-panel">
                    <!-- Tabs -->
                    <div class="flex border-b border-gray-200">
                        <button id="tab-orders" class="flex-1 p-4 font-semibold text-center border-b-2 border-blue-500 text-blue-500" onclick="showPanelTab('orders')">
                            הזמנות
                        </button>
                        <button id="tab-drivers" class="flex-1 p-4 font-semibold text-center border-b-2 border-transparent text-gray-500" onclick="showPanelTab('drivers')">
                            נהגים
                        </button>
                    </div>
                    
                    <!-- Search -->
                    <div class="p-3 border-b border-gray-200">
                        <input type="text" id="search-input" placeholder="חפש הזמנה או נהג..." class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300" onkeyup="filterLists()">
                    </div>
                    
                    <!-- Lists Wrapper -->
                    <div id="side-panel-lists" class="relative">
                        <!-- Orders List -->
                        <div id="orders-list" class="panel-list">
                            <div class="loader-container"><div class="loader"></div></div>
                        </div>
                        
                        <!-- Drivers List -->
                        <div id="drivers-list" class="panel-list" style="display: none;">
                            <div class="loader-container"><div class="loader"></div></div>
                        </div>
                    </div>
                    
                    <!-- Details Panel (New) -->
                    <div id="details-panel">
                        <div class="text-center text-gray-500 p-8">בחר נהג או הזמנה להצגת פרטים</div>
                    </div>
                </aside>
            </main>
            
            <!-- History & Customer Management View (Combined) -->
            <div id="view-history" class="app-view">
                <div class="flex border-b border-gray-200 mb-6">
                    <button class="tab-button active" onclick="showHistoryTab('orders')">היסטוריית הזמנות</button>
                    <button class="tab-button" onclick="showHistoryTab('customers')">ניהול לקוחות</button>
                </div>

                <!-- Order History Content -->
                <div id="history-orders-content">
                    <h2 class="text-2xl font-bold mb-4">היסטוריית הזמנות</h2>
                    <div class="flex flex-col lg:flex-row gap-4 mb-4 p-4 bg-white rounded-lg shadow-sm">
                        <input type="text" id="history-search" placeholder="חפש לפי מס' הזמנה, לקוח, נהג, כתובת..." class="flex-grow p-2 border rounded-md">
                        <div class="flex gap-4">
                            <input type="date" id="history-date-from" class="p-2 border rounded-md" title="מתאריך">
                            <input type="date" id="history-date-to" class="p-2 border rounded-md" title="עד תאריך">
                        </div>
                        <button id="history-filter-btn" class="px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600">סנן</button>
                    </div>
                    <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200 history-table">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">מס' הזמנה</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">לקוח</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">נהג</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">כתובת</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">סטטוס</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">תאריך</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">פעולות</th>
                                    </tr>
                                </thead>
                                <tbody id="history-table-body" class="bg-white divide-y divide-gray-200">
                                    <tr><td colspan="7" class="text-center p-8 text-gray-500">טוען היסטוריה...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                 </div>

                 <!-- Customer Management Content -->
                 <div id="history-customers-content" style="display: none;">
                     <h2 class="text-2xl font-bold mb-4">ניהול לקוחות</h2>
                     <div class="flex flex-col lg:flex-row gap-4 mb-4 p-4 bg-white rounded-lg shadow-sm">
                        <input type="text" id="customer-search-input" placeholder="חפש לפי שם, טלפון, מספר לקוח..." class="flex-grow p-2 border rounded-md" onkeyup="renderCustomerTable()">
                     </div>
                    <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200 customer-table">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">שם</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">מספר לקוח</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">טלפון</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">כתובת</th>
                                    </tr>
                                </thead>
                                <tbody id="customer-table-body" class="bg-white divide-y divide-gray-200">
                                    <tr><td colspan="4" class="text-center p-8 text-gray-500">טוען לקוחות...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                 </div>
            </div>
            
             <!-- Driver History View (New Structure) -->
            <div id="view-driver-history" class="app-view">
                 <aside id="driver-history-sidebar" class="bg-white p-4 border-l border-gray-200">
                     <h3 class="text-xl font-semibold mb-4">היסטוריית נהג</h3>
                     <div>
                         <label for="driver-select" class="block text-sm font-medium text-gray-700 mb-1">בחר נהג</label>
                         <select id="driver-select" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                             <option value="">טוען נהגים...</option>
                         </select>
                     </div>
                     <div class="grid grid-cols-2 gap-2">
                         <div>
                            <label for="driver-history-date-from" class="block text-sm font-medium text-gray-700 mb-1">מתאריך</label>
                            <input type="date" id="driver-history-date-from" class="w-full p-2 border rounded-md">
                         </div>
                         <div>
                            <label for="driver-history-time-from" class="block text-sm font-medium text-gray-700 mb-1">משעה</label>
                             <input type="time" id="driver-history-time-from" class="w-full p-2 border rounded-md">
                         </div>
                         <div>
                             <label for="driver-history-date-to" class="block text-sm font-medium text-gray-700 mb-1">עד תאריך</label>
                             <input type="date" id="driver-history-date-to" class="w-full p-2 border rounded-md">
                         </div>
                         <div>
                             <label for="driver-history-time-to" class="block text-sm font-medium text-gray-700 mb-1">עד שעה</label>
                             <input type="time" id="driver-history-time-to" class="w-full p-2 border rounded-md">
                         </div>
                     </div>
                     <button id="driver-history-filter-btn" class="w-full px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600">הצג מסלול</button>
                     <div class="mt-4 border-t pt-4 text-sm text-gray-600">
                         <p><strong>סטטוס אחרון:</strong> <span id="driver-last-status">-</span></p>
                         <p><strong>מרחק משוער:</strong> <span id="driver-distance-traveled">-</span> ק"מ</p>
                         <p><strong>זמן בין הזמנות (ממוצע):</strong> <span id="driver-avg-time">-</span> דקות</p>
                     </div>
                      <div class="mt-auto text-xs text-gray-500">
                        * נתוני היסטוריה דורשים מבנה נתונים ייעודי ב-Firestore (למשל, קולקציית `locationHistory`).
                     </div>
                 </aside>
                 <div id="driver-history-map" class="relative">
                     <div class="absolute top-2 right-2 z-10 bg-white p-2 rounded shadow text-sm">
                         מציג מסלול עבור: <span id="driver-history-map-label" class="font-semibold">-</span>
                     </div>
                     <div class="w-full h-full bg-gray-300 flex items-center justify-center text-gray-500">
                         טוען מפת היסטוריה...
                         </div>
                 </div>
            </div>
            
             <!-- *** NEW CONTAINER VIEW *** -->
            <div id="view-containers" class="app-view">
                <h2>ניהול מכולות פעילות</h2>
                
                <div class="loader-container" id="containers-loader">
                    <div class="loader"></div> <span class="ml-2">טוען נתוני מכולות...</span>
                </div>
                
                <div id="containers-content">
                    <!-- Sections for each warehouse will be generated here by JS -->
                </div>
                
                <div class="container-summary" id="containers-summary">
                    סה"כ מכולות פעילות: <span id="total-active-containers">0</span>
                </div>
            </div>

        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- New Order Modal -->
    <dialog id="new-order-modal">
        <form onsubmit="submitNewOrder(event)">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-xl font-bold">יצירת הזמנה חדשה</h3>
                <button type="button" class="text-gray-500 hover:text-gray-800" onclick="closeNewOrderForm()">
                    <i data-feather="x"></i>
                </button>
            </div>
            
            <div class="p-6 space-y-4">
                <!-- Customer Search -->
                <div>
                    <label for="customer-search" class="block text-sm font-medium mb-1">חפש לקוח קיים או הקלד שם ללקוח חדש</label>
                    <input type="text" id="customer-search" list="customer-list" class="w-full p-2 border rounded-md" oninput="handleCustomerSearch(this.value)" autocomplete="off">
                    <datalist id="customer-list"></datalist>
                </div>
                
                <!-- New Customer Fields -->
                <div id="new-customer-fields" class="p-4 bg-blue-50 border border-blue-200 rounded-lg space-y-3" style="display: none;">
                    <p class="font-semibold text-blue-700">פרטי לקוח חדש</p>
                    <input type="hidden" id="customer-id-new">
                    <input type="text" id="customer-name-new" placeholder="שם לקוח מלא" class="w-full p-2 border rounded-md">
                    <input type="text" id="customer-phone-new" placeholder="טלפון" class="w-full p-2 border rounded-md">
                    <div class="form-grid">
                        <input type="text" id="customer-street-new" placeholder="רחוב" class="w-full p-2 border rounded-md">
                        <input type="text" id="customer-streetnum-new" placeholder="מספר" class="w-full p-2 border rounded-md">
                        <input type="text" id="customer-city-new" placeholder="עיר" class="w-full p-2 border rounded-md">
                    </div>
                    <input type="text" id="customer-contact-new" placeholder="איש קשר" class="w-full p-2 border rounded-md">
                     <input type="text" id="customer-number-new" placeholder="מספר לקוח (אופציונלי)" class="w-full p-2 border rounded-md">
                </div>
                
                <!-- Existing Customer Display -->
                <div id="existing-customer-display" class="p-4 bg-gray-50 border rounded-lg" style="display: none;">
                    <input type="hidden" id="customer-id-existing">
                    <p><strong>לקוח:</strong> <span id="customer-name-display"></span> <span id="customer-number-display" class="text-sm text-gray-500"></span></p>
                    <p><strong>כתובת:</strong> <span id="customer-address-display"></span></p>
                    <p><strong>טלפון:</strong> <span id="customer-phone-display"></span></p>
                </div>
                
                <hr>
                
                <!-- Order Details -->
                <div>
                    <label for="order-number" class="block text-sm font-medium mb-1">מספר הזמנה (אופציונלי)</label>
                    <input type="text" id="order-number" placeholder="השאר ריק למזהה אוטומטי" class="w-full p-2 border rounded-md mb-4">
                 </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div class="grid grid-cols-2 gap-2">
                        <input type="date" id="order-date" class="w-full p-2 border rounded-md" required>
                        <input type="time" id="order-time" class="w-full p-2 border rounded-md">
                    </div>
                    <select id="order-delivery-type" class="w-full p-2 border rounded-md" required>
                        <option value="">סוג הובלה</option>
                        <option value="הובלת מנוף">הובלת מנוף</option>
                        <option value="הובלת משאית">הובלת משאית</option>
                        <option value="איסוף עצמי">איסוף עצמי</option>
                        <option value="עבודת מנוף">עבודת מנוף</option>
                        <option value="עבודת מנוף 15 מטר">עבודת מנוף 15 מטר</option>
                        <option value="הצבת מכולה">הצבת מכולה</option>
                        <option value="החלפת מכולה">החלפת מכולה</option>
                        <option value="הוצאת מכולה">הוצאת מכולה</option>
                        <option value="פינוי במקום">פינוי במקום</option>
                        <option value="פריקה ידנית">פריקה ידנית</option>
                    </select>
                    <!-- *** START: ADDED VIRTUAL WAREHOUSES *** -->
                    <select id="order-warehouse" class="w-full p-2 border rounded-md" required>
                        <option value="">בחר מחסן</option>
                        <option value="החרש">החרש</option>
                        <option value="התלמיד">התלמיד</option>
                        <option value="30-שארק">30-שארק (מכולה)</option>
                        <option value="32-כראדי">32-כראדי (מכולה)</option>
                        <option value="40-כראדי">40-כראדי (מכולה)</option>
                    </select>
                    <!-- *** END: ADDED VIRTUAL WAREHOUSES *** -->
                </div>

                <textarea id="order-notes" rows="3" placeholder="הערות להזמנה..." class="w-full p-2 border rounded-md"></textarea>
            </div>
            
            <div class="p-4 bg-gray-50 border-t flex justify-end space-x-3 space-x-reverse">
                <button type="button" class="px-4 py-2 bg-white border rounded-md hover:bg-gray-50" onclick="closeNewOrderForm()">
                    ביטול
                </button>
                <button type="submit" id="submit-order-btn" class="px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600">
                    צור הזמנה
                </button>
            </div>
        </form>
    </dialog>
    
    <!-- Customer Edit Modal -->
    <dialog id="customer-edit-modal">
        <form onsubmit="handleSaveCustomer(event)">
            <input type="hidden" id="customer-edit-id">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-xl font-bold" id="customer-edit-title">עריכת פרטי לקוח</h3>
                <button type="button" class="text-gray-500 hover:text-gray-800" onclick="closeCustomerEditModal()">
                    <i data-feather="x"></i>
                </button>
            </div>
            
            <div class="p-6 space-y-4 max-h-[70vh] overflow-y-auto">
                 <div class="form-grid">
                     <div>
                        <label for="customer-edit-name" class="block text-sm font-medium mb-1">שם לקוח</label>
                        <input type="text" id="customer-edit-name" class="w-full p-2 border rounded-md" required>
                     </div>
                     <div>
                        <label for="customer-edit-number" class="block text-sm font-medium mb-1">מספר לקוח</label>
                        <input type="text" id="customer-edit-number" class="w-full p-2 border rounded-md">
                     </div>
                     <div>
                         <label for="customer-edit-phone" class="block text-sm font-medium mb-1">טלפון</label>
                        <input type="tel" id="customer-edit-phone" class="w-full p-2 border rounded-md" required>
                     </div>
                     <div>
                         <label for="customer-edit-contact" class="block text-sm font-medium mb-1">איש קשר</label>
                        <input type="text" id="customer-edit-contact" class="w-full p-2 border rounded-md">
                     </div>
                 </div>
                 
                 <hr class="my-4">
                 
                 <p class="font-semibold text-gray-700">כתובת ברירת מחדל</p>
                 <div class="form-grid">
                    <input type="text" id="customer-edit-street" placeholder="רחוב" class="w-full p-2 border rounded-md" required>
                    <input type="text" id="customer-edit-streetnum" placeholder="מספר" class="w-full p-2 border rounded-md" required>
                    <input type="text" id="customer-edit-city" placeholder="עיר" class="w-full p-2 border rounded-md" required>
                 </div>
                 
                 <div>
                    <label for="customer-edit-coords" class="block text-sm font-medium mb-1">קואורדינטות (הדבק מ-Google Maps)</label>
                    <input type="text" id="customer-edit-coords" placeholder="לדוגמה: 32.12345, 34.98765" class="w-full p-2 border rounded-md">
                    <p class="text-xs text-gray-500 mt-1">אופציונלי. אם יוזן, ישמש למיקום מדויק בהזמנות לכתובת זו.</p>
                 </div>
                 
                 <div class="mt-4 border-t pt-4">
                    <h4 class="text-sm font-medium text-gray-600 mb-2">היסטוריית שינויים (אחרונים)</h4>
                    <ul id="customer-audit-log" class="text-xs text-gray-500 space-y-1 max-h-24 overflow-y-auto">
                        <li>טוען היסטוריה...</li>
                    </ul>
                 </div>
            </div>
            
            <div class="p-4 bg-gray-50 border-t flex justify-end space-x-3 space-x-reverse">
                <button type="button" class="px-4 py-2 bg-white border rounded-md hover:bg-gray-50" onclick="closeCustomerEditModal()">
                    ביטול
                </button>
                <button type="submit" id="customer-save-btn" class="px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600">
                    שמור שינויים
                </button>
            </div>
        </form>
    </dialog>
    
    <!-- *** NEW CONTAINER EDIT MODAL *** -->
    <dialog id="container-edit-modal">
        <form onsubmit="handleSaveContainerOrder(event)">
            <input type="hidden" id="container-edit-order-id">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-xl font-bold" id="container-edit-title">עריכת הזמנת מכולה</h3>
                <button type="button" class="text-gray-500 hover:text-gray-800" onclick="closeContainerEditModal()">
                    <i data-feather="x"></i>
                </button>
            </div>
            <div class="p-6 space-y-4 max-h-[70vh] overflow-y-auto">
                <p><strong>לקוח:</strong> <span id="container-edit-customer-name"></span></p>
                <p><strong>כתובת:</strong> <span id="container-edit-address"></span></p>
                <p><strong>מחסן:</strong> <span id="container-edit-warehouse"></span></p>
                <hr>
                <div>
                    <label for="container-edit-delivery-type" class="block text-sm font-medium mb-1">סוג פעולה</label>
                    <select id="container-edit-delivery-type" class="w-full p-2 border rounded-md">
                        <option value="הצבת מכולה">הצבת מכולה</option>
                        <option value="החלפת מכולה">החלפת מכולה</option>
                        <option value="הוצאת מכולה">הוצאת מכולה</option>
                        <option value="פינוי במקום">פינוי במקום</option>
                        <!-- Add other relevant types if needed -->
                    </select>
                 </div>
                 <div class="grid grid-cols-2 gap-4">
                     <div>
                        <label for="container-edit-date" class="block text-sm font-medium mb-1">תאריך פעולה</label>
                        <input type="date" id="container-edit-date" class="w-full p-2 border rounded-md">
                     </div>
                      <div>
                        <label for="container-edit-time" class="block text-sm font-medium mb-1">שעת פעולה</label>
                        <input type="time" id="container-edit-time" class="w-full p-2 border rounded-md">
                     </div>
                 </div>
                 <div>
                    <label for="container-edit-notes" class="block text-sm font-medium mb-1">הערות</label>
                    <textarea id="container-edit-notes" rows="3" class="w-full p-2 border rounded-md"></textarea>
                 </div>
            </div>
            <div class="p-4 bg-gray-50 border-t flex justify-end space-x-3 space-x-reverse">
                <button type="button" class="px-4 py-2 bg-white border rounded-md hover:bg-gray-50" onclick="closeContainerEditModal()">
                    ביטול
                </button>
                <button type="submit" id="container-save-btn" class="px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600">
                    שמור שינויים
                </button>
            </div>
        </form>
    </dialog>


    <script type="module">
        // --- Inlined Firebase SDK Imports ---
        import { initializeApp, getApps, getApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        import { getFirestore, collection, doc, onSnapshot, query, orderBy, addDoc, updateDoc, serverTimestamp, deleteDoc, arrayUnion, where, getDocs, setDoc, Timestamp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js"; // Added Timestamp
        import { getFunctions } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-functions.js";

        // --- Inlined Config Logic ---
        const firebaseConfig = {
          apiKey: "AIzaSyDq0oVwS6zbEfsgrYBRkeBq80dDUKMedzo", authDomain: "saban94-78949.firebaseapp.com", projectId: "saban94-78949",
          storageBucket: "saban94-78949.firebasestorage.app", messagingSenderId: "41553157903", appId: "1:41553157903:web:cc33d252cff023be97a87a", measurementId: "G-XV6RZDESSB"
        };
        let app, auth, db, functions;
        let initializationError = null;
        try {
            app = getApps().length ? getApp() : initializeApp(firebaseConfig);
            auth = getAuth(app); db = getFirestore(app); functions = getFunctions(app, 'europe-west1');
        } catch (error) { console.error("CRITICAL: Firebase init failed!", error); initializationError = error; }

        const MAX_AUTH_RETRIES = 3; const RETRY_DELAY_MS = 3000;
        async function ensureAuth() { /* ... (same as before) ... */ }
        const authReadyPromise = ensureAuth();

        // --- *** START: MOVED SmartLog DEFINITION *** ---
        // --- Inlined SmartLog Logic ---
        const LOG_COLLECTION = 'system_logs_v3'; const sessionId = (Date.now() + Math.random()).toString(36);
        let isDbAvailable = !!db; let authChecked = false;
        const writeLog = async (level, message, origin, context = {}, category = null, solution = null) => {
            const consoleArgs = [`[${origin}] ${level}:`, message]; if (Object.keys(context).length > 0) consoleArgs.push(context); if (category) consoleArgs.push(`[Cat: ${category}]`); if (solution) consoleArgs.push(`[Sol: ${solution}]`);
            switch (level) { case 'INFO': console.log(...consoleArgs); break; case 'WARN': console.warn(...consoleArgs); break; case 'ERROR': console.error(...consoleArgs); break; default: console.log(...consoleArgs); }
            if (!isDbAvailable) { return; }
            try {
                if (!authChecked || !auth?.currentUser) {
                    await authReadyPromise; authChecked = true;
                }
                const user = auth?.currentUser; if (!user) { console.warn("SmartLog: User missing after authReady."); return; }
                const userContext = { uid: user.uid, isAnonymous: user.isAnonymous };
                const logEntry = {
                    timestamp: serverTimestamp(), level, message: String(message), origin,
                    context: { ...JSON.parse(JSON.stringify(context || {})), sessionId, userAgent: navigator.userAgent || 'N/A', page: window.location.pathname || 'N/A' },
                    user: userContext, category: category || null, solution: solution || null
                };
                // Use addDoc for logging
                await addDoc(collection(db, LOG_COLLECTION), logEntry);
            } catch (error) {
                console.error("SmartLog FATAL ERROR writing to Firestore.", error, { originalMessage: message });
                if (error.code === 'permission-denied' || error.message.includes('permissions')) { console.warn("SmartLog: Disabling Firestore logging."); isDbAvailable = false; }
            }
        };
        const SmartLog = {
            info: (msg, origin, ctx = {}) => { writeLog('INFO', msg, origin, ctx); },
            warn: (msg, origin, ctx = {}, cat = null, sol = null) => { writeLog('WARN', msg, origin, ctx, cat, sol); },
            error: (err, origin, ctx = {}, cat = null, sol = null) => { const msg = err instanceof Error ? err.message : String(err); const stack = err instanceof Error ? err.stack : 'N/A'; writeLog('ERROR', msg, origin, { ...ctx, stack }, cat, sol); }
        };
        // --- *** END: MOVED SmartLog DEFINITION *** ---

        // --- CONFIG & STATE ---
        const ISRAEL_CENTER = [32.0853, 34.7818];
        const WAREHOUSE_LOCATIONS = { 
            "החרש": [32.13266165049073, 34.898196599998755], 
            "התלמיד": [32.16303427408473, 34.894926705310006],
            "30-שארק": null, "32-כראדי": null, "40-כראדי": null
        };
        const VIRTUAL_WAREHOUSES = ["30-שארק", "32-כראדי", "40-כראדי"];
        const ALLOWED_STATUSES = ["חדש", "שויך", "בדרך", "הושלם", "בוטל"];
        const CONTAINER_RENTAL_LIMIT_DAYS = 10;
        const CONTAINER_DELIVERY_TYPES = ["הצבת מכולה", "החלפת מכולה", "הוצאת מכולה", "פינוי במקום"];

        let state = { orders: [], drivers: [], liveLocations: {}, customers: [], activeContainers: [] };
        let map; let driverHistoryMap; let driverMarkers = {}; let orderMarkers = {}; let driverHistoryPolyline = null;
        
        // --- ICONS (Leaflet) ---
        const driverIconActive = L.icon({ /* ... */ }); const driverIconStuck = L.icon({ /* ... */ }); const orderIconNew = L.icon({ /* ... */ });

        
        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            feather.replace();
            initializeApplication();
            const orderDateInput = document.getElementById('order-date');
            if(orderDateInput) orderDateInput.value = new Date().toISOString().split('T')[0];
        });
        
        async function initializeApplication() {
            SmartLog.info("v32.0.1-FB: Initializing...", "Init"); // Version bump check
            try {
                updateStatus("מפעיל מפות...");
                initMap(); initDriverHistoryMap();
                showLoader('orders-list', true); showLoader('drivers-list', true);
                updateStatus("מאמת משתמש...");
                await authReadyPromise;
                SmartLog.info(`Firebase Auth successful.`, "Init.Auth");
                updateStatus("מחבר מאזינים...");
                listenToDrivers();
                listenToOrders(); 
                listenToLocations();
                listenToCustomers();
                document.getElementById('history-filter-btn')?.addEventListener('click', renderHistoryTable);
                document.getElementById('driver-history-filter-btn')?.addEventListener('click', fetchAndDrawDriverRoute);
                showLoader('map-loader', false);
                updateStatus("מחובר ומאזין");
            } catch (error) { 
                 SmartLog.error(error, "Init.Critical", { message: "Application initialization failed." });
                 updateStatus(`שגיאת אתחול: ${error.message}`);
                 document.getElementById('map-loader').innerHTML = `שגיאת אתחול קריטית.`;
                 showToast(`שגיאת אתחול: ${error.message}`, 'error');
             }
        }

        function initMap() { /* ... (same as before) ... */ }
        function initDriverHistoryMap() { /* ... (same as before) ... */ }
        function updateStatus(message, isError = false) { /* ... (same as before) ... */ }

        // --- FIRESTORE LISTENERS (REAL-TIME) ---
        function listenToDrivers() { /* ... (same as before) ... */ }
        function listenToOrders() { /* ... (same as before) ... */ }
        function listenToLocations() { /* ... (same as before) ... */ }
        function listenToCustomers() { /* ... (same as before) ... */ }

        // --- RENDER FUNCTIONS ---
        function renderDrivers() { /* ... (same as before) ... */ }
        function createDriverCard(driver, location, assignedCount) { /* ... (same as before) ... */ }
        function renderOrders() { /* ... (same as before) ... */ }
        function createOrderCard(order) { /* ... (same as before) ... */ }
        function renderMapMarkers() { /* ... (same as before) ... */ }
        function renderHistoryTable() { /* ... (same as before) ... */ }
        function renderCustomerTable() { /* ... (same as before) ... */ }

        // --- NEW: CONTAINER VIEW LOGIC ---
        function processAndRenderContainers() { /* ... (same as before) ... */ }
        function createContainerRow(container) { /* ... (same as before) ... */ }
        function calculateRentalDays(startDate) { /* ... (same as before) ... */ }

        // --- UI & MAP INTERACTIONS ---
        function showView(viewName) { /* ... (same as before, calls SmartLog.info) ... */ }
        window.showView = showView;
        function showHistoryTab(tabName) { /* ... (same as before) ... */ }
        window.showHistoryTab = showHistoryTab; 
        function showPanelTab(tabName) { /* ... (same as before) ... */ }
        window.showPanelTab = showPanelTab;
        function filterLists() { /* ... (same as before) ... */ }
        window.filterLists = filterLists;
        function focusOnMapItem(id, type) { /* ... (same as before) ... */ }
        function showAssignDriverModal(orderId) { /* ... (same as before) ... */ }
        window.showAssignDriverModal = showAssignDriverModal;
        async function assignOrderToDriver(orderId, driverId) { /* ... (same as before) ... */ }
        function renderDetailsPanel(id, type) { /* ... (same as before) ... */ }
        function closeDetailsPanel() { /* ... (same as before) ... */ }
        window.closeDetailsPanel = closeDetailsPanel;
        
        // --- Geocoding Function ---
        async function geocodeAddress(address) { /* ... (same as before) ... */ }

        // --- STATUS UPDATE FUNCTIONS ---
        function promptForStatusChange(orderId, currentStatus) { /* ... (same as before) ... */ }
        window.promptForStatusChange = promptForStatusChange;
        async function updateOrderStatus(orderId, newStatus) { /* ... (same as before) ... */ }
        
        // --- NEW ORDER FORM ---
        function populateCustomerDatalist() { /* ... (same as before) ... */ }
        function openNewOrderForm() { /* ... (same as before) ... */ }
        window.openNewOrderForm = openNewOrderForm;
        function closeNewOrderForm() { /* ... (same as before) ... */ }
        window.closeNewOrderForm = closeNewOrderForm;
        function handleCustomerSearch(value) { /* ... (same as before) ... */ }
        window.handleCustomerSearch = handleCustomerSearch;
        async function submitNewOrder(event) { /* ... (same as before) ... */ }
        window.submitNewOrder = submitNewOrder;

         // --- CUSTOMER EDIT MODAL ---
         function openCustomerEditModal(customerId) { /* ... (same as before) ... */ }
         window.openCustomerEditModal = openCustomerEditModal;
         function closeCustomerEditModal() { /* ... (same as before) ... */ }
         window.closeCustomerEditModal = closeCustomerEditModal;
         async function handleSaveCustomer(event) { /* ... (same as before) ... */ }
         window.handleSaveCustomer = handleSaveCustomer;

         // --- DRIVER HISTORY PAGE ---
         function populateDriverSelector() { /* ... (same as before) ... */ }
         async function fetchAndDrawDriverRoute() { /* ... (same as before) ... */ }
         window.fetchAndDrawDriverRoute = fetchAndDrawDriverRoute;
         function drawRouteOnHistoryMap(latLngPoints) { /* ... (same as before) ... */ }
         function calculateRouteDistance(points) { /* ... (same as before) ... */ }
        
        // --- HELPERS ---
        function showLoader(elementId, show) { /* ... (same as before) ... */ }
        function showToast(message, type = 'info') { /* ... (same as before) ... */ }
        function copyToClipboard(text) { /* ... (same as before) ... */ }
        function copyCustomerLink(orderId) { /* ... (same as before) ... */ }
        window.copyCustomerLink = copyCustomerLink;
        async function sendGlobalPing() { /* ... (same as before) ... */ }
        window.sendGlobalPing = sendGlobalPing;

        // --- NEW: CONTAINER EDIT MODAL FUNCTIONS ---
        function openContainerEditModal(orderId) { /* ... (same as before) ... */ }
        window.openContainerEditModal = openContainerEditModal; // Make global
        function closeContainerEditModal() { /* ... (same as before) ... */ }
        window.closeContainerEditModal = closeContainerEditModal; // Make global
        async function handleSaveContainerOrder(event) { /* ... (same as before) ... */ }
        window.handleSaveContainerOrder = handleSaveContainerOrder; // Make global

        // --- Make remaining functions globally accessible ---
        // (Ensure these don't conflict or aren't already assigned)
        // Example: window.someOtherFunction = someOtherFunction;

    </script>
</body>
</html>

